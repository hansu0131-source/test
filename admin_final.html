<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ¥• ë‹¹ - ìˆ™ì œ ê´€ë¦¬ì</title>

<!-- Firebase compat SDK -->
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>

<style>
    *{box-sizing:border-box;}

    body{
        background:#FFF5E8;
        font-family:-apple-system,BlinkMacSystemFont,"Pretendard",system-ui,sans-serif;
        margin:0;
        padding:16px;
        color:#4b3525;
    }

    h1{
        text-align:center;
        color:#ff8a3c;
        margin:0 0 6px 0;
        font-size:22px;
    }

    .tag{
        text-align:center;
        font-size:12px;
        color:#fff;
        background:#ffb37a;
        padding:4px 12px;
        border-radius:999px;
        display:inline-block;
        margin:0 auto 18px;
        display:block;
    }

    .section-title{
        font-size:15px;
        font-weight:700;
        margin-bottom:8px;
        color:#ff8a3c;
        display:flex;
        align-items:center;
        gap:6px;
    }
    .section-title .sub{
        font-size:12px;
        font-weight:400;
        color:#b07b55;
    }

    .card{
        background:#fff;
        padding:12px;
        border-radius:14px;
        box-shadow:0 3px 10px rgba(255,150,95,0.22);
        margin-bottom:16px;
    }

    .input-small-label{
        font-size:12px;
        color:#79533a;
        margin-bottom:4px;
    }

    textarea{
        width:100%;
        min-height:70px;
        border-radius:10px;
        border:1px solid #ffcfac;
        padding:8px;
        resize:vertical;
        font-family:inherit;
        font-size:13px;
        background:#fffdfa;
    }

    button{
        padding:8px 14px;
        border:none;
        border-radius:999px;
        background:#ff8a3c;
        color:#fff;
        font-weight:600;
        cursor:pointer;
        font-size:13px;
    }
    button:active{transform:translateY(1px);}
    .btn-sub{background:#ffd2ae;color:#9f4e23;}
    .btn-danger{background:#ffebe1;color:#ff5c37;}

    .small-helper{
        font-size:11px;
        color:#aa7c5b;
        margin-top:4px;
    }

    /* ì˜¤ëŠ˜/ë°€ë¦° ìˆ™ì œ - 3x3 ìˆ«ì ì¹© */
    .summary-grid{
        display:grid;
        grid-template-columns:repeat(3,1fr);
        gap:8px;
        max-width:520px;
    }
    .summary-box{
        background:#ffe3f2;
        border-radius:14px;
        padding:4px 6px 8px;
        text-align:center;
    }
    .summary-label{
        font-size:12px;
        color:#c0567c;
        margin-bottom:2px;
    }
    .summary-input{
        width:100%;
        max-width:90px;
        margin:0 auto;
        padding:4px 0;
        border-radius:999px;
        border:1px solid #ffb8de;
        background:#fff;
        text-align:center;
        font-size:13px;
    }
    .summary-input[disabled]{
        background:#fff6fb;
        color:#b56790;
    }

    /* ìˆ™ì œ ì¹´ë“œ í•­ëª© ê´€ë¦¬ */
    .pill{
        display:inline-flex;
        align-items:center;
        padding:4px 10px;
        border-radius:999px;
        background:#ffe9d7;
        font-size:12px;
        margin:2px;
        gap:6px;
    }
    .pill button{
        padding:0 6px;
        font-size:11px;
        background:transparent;
        color:#ff4b24;
        box-shadow:none;
    }

    .input-line{
        display:flex;
        gap:8px;
        margin-bottom:8px;
    }
    .input-line input[type="text"]{
        flex:1;
        padding:7px;
        border-radius:9px;
        border:1px solid #ffd1a4;
        font-size:13px;
        background:#fffdfa;
    }

    /* ìˆ™ì œ ì¹´ë“œ ëª©ë¡ */
    .space-card{
        margin-bottom:10px;
        padding:10px;
        border-radius:14px;
        background:#fffdf8;
        border:1px solid #ffe4c9;
        box-shadow:0 2px 6px rgba(0,0,0,0.03);
    }
    .space-header{
        display:flex;
        justify-content:space-between;
        align-items:center;
        gap:8px;
        margin-bottom:6px;
    }
    .space-main{
        display:flex;
        flex-direction:column;
        gap:4px;
    }
    .badge-nick{
        font-size:13px;
        font-weight:600;
        padding:4px 10px;
        border-radius:999px;
        background:#ffe0c2;
        color:#8b4b20;
        display:inline-flex;
        align-items:center;
        gap:4px;
    }
    .badge-nick input{
        border:none;
        background:transparent;
        font-size:13px;
        width:140px;
    }
    .badge-id{
        font-size:11px;
        padding:4px 8px;
        border-radius:999px;
        background:#fff6eb;
        color:#a85a23;
        display:inline-flex;
        align-items:center;
        gap:4px;
    }
    .badge-id button{
        padding:2px 6px;
        font-size:10px;
        border-radius:999px;
        background:#ffbf86;
        color:#fff;
    }
    .space-fields{
        display:flex;
        flex-wrap:wrap;
        gap:6px;
        margin-top:6px;
        margin-bottom:6px;
    }
    .field-chip{
        flex:0 1 calc(33.333% - 4px);
        min-width:90px;
        background:#ffe3f2;
        border-radius:14px;
        padding:4px 6px 8px;
        text-align:center;
    }
    .field-chip-label{
        font-size:12px;
        color:#c0567c;
        margin-bottom:2px;
    }
    .field-chip input{
        width:100%;
        max-width:90px;
        margin:0 auto;
        padding:4px 0;
        border-radius:999px;
        border:1px solid #ffb8de;
        background:#fff;
        text-align:center;
        font-size:13px;
    }

    .memo-balloon{
        display:flex;
        gap:8px;
        margin-top:6px;
    }
    .memo-balloon .col{
        flex:1;
    }
    .memo-balloon textarea{
        min-height:70px;
    }

    .space-footer{
        display:flex;
        justify-content:flex-end;
        margin-top:6px;
    }

    @media (max-width:480px){
        .summary-grid{
            gap:6px;
        }
        .field-chip{
            flex:0 1 calc(50% - 4px);
        }
        .badge-nick input{
            width:110px;
        }
    }

    @media (min-width:720px){
        body{
            max-width:640px;
            margin:0 auto;
        }
    }
</style>
</head>
<body>

<h1>ğŸ¥• ë‹¹ - ìˆ™ì œ ê´€ë¦¬ì</h1>
<div class="tag">ê´€ë¦¬ì ID: ë‹¹ (ì£¼í™©)</div>

<!-- ì˜¤ëŠ˜ì˜ í•œë§ˆë”” -->
<div class="card">
    <div class="section-title">ğŸ“Œ ì˜¤ëŠ˜ì˜ í•œë§ˆë”” <span class="sub">(ê´€ë¦¬ì â†” ì‚¬ìš©ì)</span></div>

    <div class="input-small-label">ğŸ¥• ê´€ë¦¬ì â†’ ì‚¬ìš©ì</div>
    <textarea id="adminMessage" placeholder="ë‚­ì—ê²Œ ì˜¤ëŠ˜ ì „í•˜ê³  ì‹¶ì€ ë§"></textarea>
    <div style="margin-top:6px; text-align:right;">
        <button onclick="saveAdminMessage()">ê´€ë¦¬ì í•œë§ˆë”” ì €ì¥</button>
    </div>

    <div style="height:10px;"></div>

    <div class="input-small-label">ğŸ° ì‚¬ìš©ì â†’ ê´€ë¦¬ì</div>
    <div id="userMessageBox"
         style="white-space:pre-line; padding:8px; border-radius:10px; border:1px solid #ffd7c2; background:#fff8f3; font-size:13px;">
        (ì•„ì§ ì‚¬ìš©ì ë©”ì‹œì§€ê°€ ì—†ìŠµë‹ˆë‹¤)
    </div>
</div>

<!-- ì˜¤ëŠ˜ ìˆ™ì œ -->
<div class="card">
    <div class="section-title">
        ğŸ“¦ <span id="todayTitleDate">ì˜¤ëŠ˜ ìˆ™ì œ</span>
    </div>
    <div class="small-helper">ì˜¤ëŠ˜ í•´ì•¼ í•  ìˆ™ì œ ìˆ«ìë¥¼ ì ì–´ ì£¼ì„¸ìš”. í•©ê³„ëŠ” ì €ì¥ ì‹œ ìë™ ê³„ì‚°ë©ë‹ˆë‹¤.</div>

    <div class="summary-grid" id="todayGrid">
        <!-- JSì—ì„œ ì±„ì›€ -->
    </div>

    <div style="margin-top:10px; text-align:right;">
        <button class="btn-sub" onclick="saveSummary('today')">ì˜¤ëŠ˜ ìˆ™ì œ ì €ì¥</button>
    </div>
</div>

<!-- ë°€ë¦° ìˆ™ì œ -->
<div class="card">
    <div class="section-title">ğŸ“¦ ë°€ë¦° ìˆ™ì œ</div>
    <div class="small-helper">ë°€ë ¤ ìˆëŠ” ìˆ™ì œ ìˆ«ìë¥¼ ì ì–´ ì£¼ì„¸ìš”. í•©ê³„ëŠ” ì €ì¥ ì‹œ ìë™ ê³„ì‚°ë©ë‹ˆë‹¤.</div>

    <div class="summary-grid" id="backlogGrid">
        <!-- JSì—ì„œ ì±„ì›€ -->
    </div>

    <div style="margin-top:10px; text-align:right;">
        <button class="btn-sub" onclick="saveSummary('backlog')">ë°€ë¦° ìˆ™ì œ ì €ì¥</button>
    </div>
</div>

<!-- ìˆ™ì œ ì¹´ë“œ í•­ëª© ê´€ë¦¬ -->
<div class="card">
    <div class="section-title">ğŸ“Œ ìˆ™ì œ ì¹´ë“œ í•­ëª© ê´€ë¦¬</div>
    <div class="input-small-label">ìˆ™ì œ ì¹´ë“œ ì•ˆì— ë“¤ì–´ê°ˆ í•­ëª© ì´ë¦„ì„ ì¶”ê°€í•˜ê±°ë‚˜ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
    <div class="input-line">
        <input type="text" id="newField" placeholder="ìƒˆ í•­ëª© ì´ë¦„ (ì˜ˆ: ì—­íŒ¬ / ë°°ë¯¼ / ì •ì„± ...)">
        <button onclick="addField()">í•­ëª© ì¶”ê°€</button>
    </div>
    <div class="field-list">
        <div class="input-small-label">í˜„ì¬ í•­ëª©ë“¤</div>
        <div id="fieldPills"></div>
    </div>
</div>

<!-- ìˆ™ì œ ì¹´ë“œ ëª©ë¡ -->
<div class="card">
    <div class="section-title">ğŸ“ ìˆ™ì œ ì¹´ë“œ</div>
    <div class="small-helper">
        ê´€ë¦¬ìê°€ ë§Œë“¤ì–´ ì¤€ ì¹´ë“œì…ë‹ˆë‹¤. ê° í•­ëª©ì˜ ìˆ«ìì™€ ë©”ëª¨, í’ì„  ë‚´ìš©ì„ ì±„ìš´ ë’¤
        ëª¨ë‘ ëë‚œ ì¹´ë“œëŠ” <b>ì™„ë£Œ ğŸ°</b> ë²„íŠ¼ì„ ëˆŒëŸ¬ ì •ë¦¬í•´ ì£¼ì„¸ìš”.
    </div>
    <div id="spacesContainer"></div>
</div>

<script>
/* ---------------- Firebase ì´ˆê¸°í™” ---------------- */
const firebaseConfig = {
    apiKey:"AIzaSyAHmLNi5VOuAE-gXnAg-fEfzylPZvzvfVo",
    authDomain:"daily-checklist-91e5a.firebaseapp.com",
    projectId:"daily-checklist-91e5a",
    storageBucket:"daily-checklist-91e5a.firebasestorage.app",
    messagingSenderId:"66394691958",
    appId:"1:66394691958:web:cf91f295456a2e10d18257",
    measurementId:"G-87WK4N4EGH"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* ---------------- ì»¬ë ‰ì…˜/ë¬¸ì„œ ì°¸ì¡° ---------------- */
const todayMessagesRef = db.collection("today").doc("messages");

const summaryTodayRef   = db.collection("summary").doc("today");
const summaryBacklogRef = db.collection("summary").doc("backlog");

const configRef  = db.collection("config").doc("checklist");
const spacesRef  = db.collection("spaces");

/* ---------------- ìƒíƒœ ---------------- */
let cardFields = [];        // ìˆ™ì œ ì¹´ë“œ í•­ëª© ì´ë¦„ë“¤
let spacesData = [];        // ìˆ™ì œ ì¹´ë“œ ëª©ë¡
const SUMMARY_LAYOUT = [
    { key:"baemin",  label:"ë°°ë¯¼" },
    { key:"bangsel", label:"ë°©ì…€" },
    { key:"umjjal",  label:"ì›€ì§¤" },
    { key:"yeok",    label:"ì—­íŒ¬" },
    { key:"jeong",   label:"ì •ì„±" },
    { key:"photo",   label:"ì‚¬ì§„" },
    { key:"sumBaeyeok", label:"í•©ê³„" },
    { key:"video",      label:"ì˜ìƒ" },
    { key:"sumUmSa",    label:"í•©ê³„" }
];

/* ì˜¤ëŠ˜ íƒ€ì´í‹€ ë‚ ì§œ(11ì›” 21ì¼(ê¸ˆ) í˜•ì‹) */
(function setTodayTitle(){
    const now = new Date();
    const m = now.getMonth()+1;
    const d = now.getDate();
    const week = ["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "][now.getDay()];
    document.getElementById("todayTitleDate").innerText = `${m}ì›” ${d}ì¼(${week}) ìˆ™ì œ`;
})();

/* summary grid DOM ìƒì„± */
function buildSummaryGrid(containerId){
    const container = document.getElementById(containerId);
    container.innerHTML = "";
    SUMMARY_LAYOUT.forEach(field=>{
        const box = document.createElement("div");
        box.className = "summary-box";
        box.innerHTML = `
            <div class="summary-label">${field.label}</div>
            <input type="number" id="${containerId}-${field.key}"
                   class="summary-input" min="0" value="0"
                   ${field.key.startsWith("sum") ? "disabled" : ""}>
        `;
        container.appendChild(box);
    });
}
buildSummaryGrid("todayGrid");
buildSummaryGrid("backlogGrid");

/* ---------------- ì˜¤ëŠ˜ì˜ í•œë§ˆë”” ---------------- */
todayMessagesRef.onSnapshot(doc=>{
    if(!doc.exists){
        todayMessagesRef.set({
            adminMessage:"",
            userMessage:"",
            date:new Date().toISOString()
        },{merge:true});
        return;
    }
    const data = doc.data();
    document.getElementById("adminMessage").value = data.adminMessage || "";
    document.getElementById("userMessageBox").innerText =
        data.userMessage || "(ì•„ì§ ì‚¬ìš©ì ë©”ì‹œì§€ê°€ ì—†ìŠµë‹ˆë‹¤)";
});

function saveAdminMessage(){
    const msg = document.getElementById("adminMessage").value;
    todayMessagesRef.set({
        adminMessage:msg,
        date:new Date().toISOString()
    },{merge:true})
    .then(()=>alert("ê´€ë¦¬ì í•œë§ˆë””ë¥¼ ì €ì¥í–ˆì–´ìš”."))
    .catch(err=>{
        console.error(err);
        alert("ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”.");
    });
}

/* ---------------- ìš”ì•½(ì˜¤ëŠ˜/ë°€ë¦°) ---------------- */
function applySummaryToUI(docData, prefix){
    SUMMARY_LAYOUT.forEach(f=>{
        const el = document.getElementById(prefix+"-"+f.key);
        if(!el) return;
        const v = docData && typeof docData[f.key]==="number" ? docData[f.key] : 0;
        el.value = v;
    });
}

summaryTodayRef.onSnapshot(doc=>{
    if(!doc.exists){
        summaryTodayRef.set({}, {merge:true});
        return;
    }
    applySummaryToUI(doc.data(),"todayGrid");
});

summaryBacklogRef.onSnapshot(doc=>{
    if(!doc.exists){
        summaryBacklogRef.set({}, {merge:true});
        return;
    }
    applySummaryToUI(doc.data(),"backlogGrid");
});

function collectSummaryPayload(prefix){
    const payload = {};
    SUMMARY_LAYOUT.forEach(f=>{
        const el = document.getElementById(prefix+"-"+f.key);
        if(!el) return;
        const num = Number(el.value || 0);
        payload[f.key] = isNaN(num) ? 0 : num;
    });
    // í•©ê³„ ìë™ ê³„ì‚°
    payload.sumBaeyeok = (payload.baemin || 0) + (payload.yeok || 0);
    payload.sumUmSa    = (payload.umjjal || 0) + (payload.photo || 0);
    return payload;
}

function saveSummary(type){
    const prefix = type==="today" ? "todayGrid" : "backlogGrid";
    const ref    = type==="today" ? summaryTodayRef : summaryBacklogRef;

    const payload = collectSummaryPayload(prefix);
    payload.updatedAt = new Date();

    // UIì—ë„ í•©ê³„ ê°’ ë°˜ì˜
    document.getElementById(prefix+"-sumBaeyeok").value = payload.sumBaeyeok;
    document.getElementById(prefix+"-sumUmSa").value    = payload.sumUmSa;

    ref.set(payload,{merge:true})
       .then(()=>alert(type==="today" ? "ì˜¤ëŠ˜ ìˆ™ì œë¥¼ ì €ì¥í–ˆì–´ìš”." : "ë°€ë¦° ìˆ™ì œë¥¼ ì €ì¥í–ˆì–´ìš”."))
       .catch(err=>{
           console.error(err);
           alert("ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”.");
       });
}

/* ---------------- ìˆ™ì œ ì¹´ë“œ í•­ëª© ê´€ë¦¬ ---------------- */
configRef.onSnapshot(doc=>{
    if(!doc.exists){
        const defaults = ["ì—­íŒ¬","ë°°ë¯¼","ì •ì„±","ì˜ìƒ","ë°©ì…€"];
        configRef.set({cardFields:defaults},{merge:true});
        cardFields = defaults;
    }else{
        const data = doc.data() || {};
        if(Array.isArray(data.cardFields) && data.cardFields.length){
            cardFields = data.cardFields;
        }else if(Array.isArray(data.fields) && data.fields.length){
            // ì´ì „ ë²„ì „ í˜¸í™˜
            cardFields = data.fields;
            configRef.set({cardFields:cardFields},{merge:true});
        }else{
            cardFields = ["ì—­íŒ¬","ë°°ë¯¼","ì •ì„±","ì˜ìƒ","ë°©ì…€"];
            configRef.set({cardFields:cardFields},{merge:true});
        }
    }
    renderFieldPills();
    renderSpaces();
});

function renderFieldPills(){
    const wrap = document.getElementById("fieldPills");
    wrap.innerHTML = "";
    if(!cardFields.length){
        wrap.innerHTML = '<div class="small-helper">ì•„ì§ ë“±ë¡ëœ í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
        return;
    }
    cardFields.forEach(name=>{
        const pill = document.createElement("div");
        pill.className = "pill";
        pill.innerHTML = `
            <span>${name}</span>
            <button type="button" onclick="deleteField('${name}')">X</button>
        `;
        wrap.appendChild(pill);
    });
}

function addField(){
    const input = document.getElementById("newField");
    const name = input.value.trim();
    if(!name) return;
    configRef.update({
        cardFields: firebase.firestore.FieldValue.arrayUnion(name)
    }).then(()=>{ input.value=""; })
      .catch(err=>{
          console.error(err);
          alert("í•­ëª© ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”.");
      });
}

function deleteField(name){
    if(!confirm(`"${name}" í•­ëª©ì„ ì‚­ì œí• ê¹Œìš”?`)) return;
    configRef.update({
        cardFields: firebase.firestore.FieldValue.arrayRemove(name)
    }).catch(err=>{
        console.error(err);
        alert("í•­ëª© ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”.");
    });
}

/* ---------------- ìˆ™ì œ ì¹´ë“œ ëª©ë¡ ---------------- */
spacesRef.onSnapshot(snapshot=>{
    spacesData = snapshot.docs.map(d=>({id:d.id, ...d.data()}));
    renderSpaces();
});

function copyUserId(value){
    if(!value) return;
    if(navigator.clipboard && navigator.clipboard.writeText){
        navigator.clipboard.writeText(value)
            .then(()=>alert("ì•„ì´ë””ë¥¼ ë³µì‚¬í–ˆì–´ìš”: "+value))
            .catch(()=>alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆì–´ìš”. ì§ì ‘ ë³µì‚¬í•´ ì£¼ì„¸ìš”."));
    }else{
        alert("ìë™ ë³µì‚¬ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤. ì§ì ‘ ë³µì‚¬í•´ ì£¼ì„¸ìš”.");
    }
}

function updateSpaceField(docId, field, value){
    spacesRef.doc(docId).update({[field]:value})
        .catch(err=>{
            console.error(err);
            alert("ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”.");
        });
}

function updateSpaceCount(docId, field, value){
    const num = Number(value || 0);
    spacesRef.doc(docId).update({
        ["counts."+field]: isNaN(num)?0:num
    }).catch(err=>{
        console.error(err);
        alert("ìˆ«ì ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”.");
    });
}

function deleteSpace(docId){
    if(!confirm("ì´ ìˆ™ì œ ì¹´ë“œë¥¼ ì •ë§ ì™„ë£Œ(ì‚­ì œ)í• ê¹Œìš”?\nëª¨ë“  ë‚´ìš©ì´ ì‚­ì œë©ë‹ˆë‹¤.")) return;
    spacesRef.doc(docId).delete()
        .catch(err=>{
            console.error(err);
            alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”.");
        });
}

function renderSpaces(){
    const container = document.getElementById("spacesContainer");
    container.innerHTML = "";

    if(!spacesData.length){
        container.innerHTML = '<div class="small-helper">ì•„ì§ ìƒì„±ëœ ìˆ™ì œ ì¹´ë“œê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
        return;
    }

    spacesData.forEach(item=>{
        const counts = item.counts || {};
        const card = document.createElement("div");
        card.className = "space-card";

        card.innerHTML = `
            <div class="space-header">
                <div class="space-main">
                    <div class="badge-nick">
                        ë‹‰ë„¤ì„:
                        <input type="text" value="${item.nickname || ""}"
                               onchange="updateSpaceField('${item.id}','nickname',this.value)">
                    </div>
                    <div class="badge-id">
                        <span>ì•„ì´ë””: ${item.userid || ""}</span>
                        <button type="button" onclick="copyUserId('${item.userid || ""}')">ë³µì‚¬</button>
                    </div>
                </div>
                <button class="btn-danger" type="button"
                        onclick="deleteSpace('${item.id}')">ì™„ë£Œ ğŸ°</button>
            </div>

            <div class="space-fields">
                ${cardFields.map(name=>`
                    <div class="field-chip">
                        <div class="field-chip-label">${name}</div>
                        <input type="number" min="0"
                               value="${typeof counts[name]==='number' ? counts[name] : 0}"
                               onchange="updateSpaceCount('${item.id}','${name}',this.value)">
                    </div>
                `).join("")}
            </div>

            <div class="memo-balloon">
                <div class="col">
                    <div class="input-small-label">ë©”ëª¨</div>
                    <textarea onchange="updateSpaceField('${item.id}','memo',this.value)">${item.memo || ""}</textarea>
                </div>
                <div class="col">
                    <div class="input-small-label">í’ì„ </div>
                    <textarea onchange="updateSpaceField('${item.id}','balloon',this.value)">${item.balloon || ""}</textarea>
                </div>
            </div>
        `;
        container.appendChild(card);
    });
}
</script>
</body>
</html>
